<div class="d-flex justify-content-between align-items-center mb-2">
    <h2 class="mb-0">{{isEditMode ? 'Update Product' : 'Add Product'}}</h2>
    <button 
    (click)="onClose()"
    mat-mini-fab class="bg-secondary"><mat-icon>close</mat-icon></button>
</div>
<form #productForm="ngForm" (ngSubmit)="onProductAdd()">
    <mat-form-field appearance="fill" class="w-100">
        <mat-label>Title</mat-label>
        <input 
        required
        ngModel
        name="title"
        matInput>
    </mat-form-field>
    <mat-form-field appearance="fill" class="w-100">
        <mat-label>Description</mat-label>
        <textarea 
        required
        ngModel
        name="description"
        rows="4"
        matInput></textarea>
    </mat-form-field>
    <div class="row">
        <mat-form-field appearance="fill" class="col-md-6" [class.form-group]="priceControl.hasError('pattern')">
            <mat-label>Price(INR)</mat-label>
            <input 
            required
            #priceControl="ngModel"
            pattern="^[0-9]*$"
            ngModel
            name="price"
            matInput>
            <mat-error *ngIf="priceControl.hasError('pattern')">
                Only numbers allowed
            </mat-error>
        </mat-form-field>
        <mat-form-field appearance="fill" class="col-md-6" [class.form-group]="discountControl.hasError('pattern')">
            <mat-label>Discount(%)</mat-label>
            <input 
            required
            #discountControl="ngModel"
            pattern="^(?:[1-9]|[1-7][0-9]|80)$"
            ngModel
            name="discount"
            matInput>
            <mat-error *ngIf="discountControl.hasError('pattern')">
                Only numbers 1 to 80 allowed
            </mat-error>
        </mat-form-field>
    </div>
    <div class="row">
        <mat-form-field appearance="fill" class="col-md-6">
            <mat-label>In Stock</mat-label>
            <mat-select 
            required
            ngModel
            name="availability"
            matInput>
                <mat-option value="In Stock">Yes</mat-option>
                <mat-option value="Out of Stock">No</mat-option>
            </mat-select>
        </mat-form-field>
        <mat-form-field appearance="fill" class="col-md-6">
            <mat-label>Rating</mat-label>
            <mat-select 
            required
            ngModel
            name="rating"
            matInput>
                <mat-option value="1">1</mat-option>
                <mat-option value="2">2</mat-option>
                <mat-option value="3">3</mat-option>
                <mat-option value="4">4</mat-option>
                <mat-option value="5">5</mat-option>
            </mat-select>
        </mat-form-field>
    </div>
    <div *ngIf="!isEditMode">
        <mat-form-field appearance="fill" class="w-100">
            <mat-label>Paste Image Url</mat-label>
            <input 
            #imgUrlControl
            matInput>
            <button
            type="button" 
            (click)="onAddUrl(imgUrlControl)"
            matSuffix mat-icon-button>
              <mat-icon>add</mat-icon>
            </button>
        </mat-form-field>
        <span *ngIf="imgArray.length < 1; else imgsNumber" class="text-danger">
            Add at least one image url, use + icon to add one image at a time
        </span>
        <ng-template #imgsNumber>
            <span>
                Images added: {{imgArray.length}}
            </span>
        </ng-template>    
    </div>
    <div class="text-right">
        <button
        [disabled]="imgArray.length < 1" 
        *ngIf="!isEditMode"
        mat-raised-button color="primary">Add</button>
        <button
        (click)="onProductUpdate()"
        type="button" 
        *ngIf="isEditMode"
        mat-raised-button color="primary">Update</button>
    </div>
</form>